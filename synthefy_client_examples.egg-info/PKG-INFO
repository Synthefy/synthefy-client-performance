Metadata-Version: 2.4
Name: synthefy-client-examples
Version: 0.1.0
Summary: Example scripts demonstrating Synthefy client usage
Author-email: Synthefy <contact@synthefy.com>
Classifier: Development Status :: 4 - Beta
Classifier: Intended Audience :: Developers
Classifier: License :: OSI Approved :: MIT License
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.9
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Requires-Python: >=3.9
Description-Content-Type: text/markdown
Requires-Dist: synthefy@ file://{env:SYNTHEFY_PACKAGE_BASE}/synthefy
Requires-Dist: pandas>=1.5.0
Requires-Dist: numpy>=1.20.0
Requires-Dist: pyright>=1.1.406
Provides-Extra: dev
Requires-Dist: pytest>=7.0.0; extra == "dev"
Requires-Dist: black>=22.0.0; extra == "dev"
Requires-Dist: flake8>=4.0.0; extra == "dev"
Requires-Dist: mypy>=0.950; extra == "dev"

# Synthefy Client Examples

This directory contains example scripts demonstrating how to use the Synthefy Python client to make forecast requests to the `/api/v2/foundation_models/forecast/stream` endpoint.

## Prerequisites

### 1. Install Dependencies

#### Option A: Using Virtual Environment (Recommended)

```bash
# Create and activate virtual environment
python -m venv .venv
source .venv/bin/activate  # On Windows: .venv\Scripts\activate

# Install dependencies from pyproject.toml
pip install -e .
```

#### Option B: Using requirements.txt

```bash
pip install -r requirements.txt
```

#### Option C: Manual Installation

```bash
pip install synthefy>=2.0.4 pandas>=1.5.0 numpy>=1.20.0
```

### 2. Set Up API Key

Set your Synthefy API key as an environment variable:

```bash
export SYNTHEFY_API_KEY='your_api_key_here'
```

### 3. Ensure Server is Running

Make sure your local Synthefy server is running on `http://localhost:8014`. The examples are configured to connect to this local endpoint.

## Virtual Environment Setup

This project includes a `pyproject.toml` file for modern Python dependency management. The virtual environment approach is recommended for isolation and reproducibility.

### Quick Start with Virtual Environment

```bash
# Navigate to the project directory
cd synthefy_client_with_obscure_image

# Create virtual environment
python -m venv .venv

# Activate virtual environment
source .venv/bin/activate  # On Windows: .venv\Scripts\activate

# Install the project and its dependencies
pip install -e .

# Verify installation
python -c "from synthefy import SynthefyAPIClient; print('✅ Ready to use!')"

# Test the setup (optional)
python -c "
import os
os.environ['SYNTHEFY_API_KEY'] = 'test-key'
from synthefy import SynthefyAPIClient
from synthefy.data_models import ForecastV2Request, SingleEvalSamplePayload
print('✅ All imports and basic functionality working!')
"
```

### Deactivating the Virtual Environment

```bash
deactivate
```

### Virtual Environment Benefits

- **Isolation**: Dependencies are isolated from your system Python
- **Reproducibility**: Exact dependency versions are locked
- **Clean Environment**: No conflicts with other projects
- **Easy Cleanup**: Simply delete the `.venv` directory to remove everything

## Examples

### 1. Basic Example (`example_basic.py`)

Demonstrates the most basic usage of the Synthefy client, matching the curl command:

```bash
python example_basic.py
```

This example:
- Creates a `ForecastV2Request` with a single time series
- Uses the `SynthefyAPIClient` to make the request
- Handles common errors gracefully
- Displays forecast results

**Expected Output:**
```
Making forecast request to localhost:8014...
Model: sfm-moe-v1
Number of samples: 1
Sample details: 1 time series in first scenario

Sending request...

✅ Forecast successful!
Number of forecast scenarios: 1

Scenario 1:
  Sample ID: sales
  Model: sfm-moe-v1
  Timestamps: ['2023-01-06', '2023-01-07', '2023-01-08']
  Values: [150.0, 160.0, 170.0]
```

### 2. DataFrame Example (`example_dataframes.py`)

Demonstrates using pandas DataFrames with the convenience `forecast_dfs()` method:

```bash
python example_dataframes.py
```

This example:
- Creates historical and target DataFrames
- Uses the `forecast_dfs()` convenience method
- Returns results as DataFrames for easy analysis
- Shows the same forecast scenario as the basic example

**Expected Output:**
```
Creating sample data...
Historical data shape: (5, 2)
Target data shape: (3, 2)
Historical date range: 2023-01-01 00:00:00 to 2023-01-05 00:00:00
Target date range: 2023-01-06 00:00:00 to 2023-01-08 00:00:00

Historical data:
        date  sales
0 2023-01-01  100.0
1 2023-01-02  110.0
2 2023-01-03  120.0
3 2023-01-04  130.0
4 2023-01-05  140.0

Target data:
        date  sales
0 2023-01-06    NaN
1 2023-01-07    NaN
2 2023-01-08    NaN

Making forecast request using DataFrames...

✅ Forecast successful!
Number of forecast DataFrames: 1

Forecast DataFrame shape: (3, 2)

Forecast results:
        date  sales
0 2023-01-06  150.0
1 2023-01-07  160.0
2 2023-01-08  170.0

Forecasted sales values:
  2023-01-06: 150.0
  2023-01-07: 160.0
  2023-01-08: 170.0
```

### 3. Multiple Scenarios Example (`example_multiple_scenarios.py`)

Demonstrates batch forecasting with multiple scenarios:

```bash
python example_multiple_scenarios.py
```

This example:
- Creates multiple forecast scenarios with different trends
- Shows scenarios with and without metadata columns
- Demonstrates batch processing capabilities
- Compares different forecasting scenarios

**Expected Output:**
```
=== Multiple Scenarios Example ===
Creating multiple forecast scenarios...
Created 3 scenarios
  Scenario 1: sales_high_growth
    History values: [100.0, 120.0, 140.0, 160.0, 180.0]
    Target timestamps: ['2023-01-06', '2023-01-07', '2023-01-08']
  Scenario 2: sales_stable
    History values: [100.0, 105.0, 98.0, 102.0, 101.0]
    Target timestamps: ['2023-01-06', '2023-01-07', '2023-01-08']
  Scenario 3: sales_declining
    History values: [200.0, 190.0, 180.0, 170.0, 160.0]
    Target timestamps: ['2023-01-06', '2023-01-07', '2023-01-08']

Request details:
  Model: sfm-moe-v1
  Number of scenarios: 3

Sending multiple scenario request...

✅ Multiple scenario forecast successful!
Number of forecast scenarios returned: 3

--- Scenario 1 Results ---
Sample ID: sales_high_growth
Model: sfm-moe-v1
Timestamps: ['2023-01-06', '2023-01-07', '2023-01-08']
Values: [200.0, 220.0, 240.0]
Forecast stats: min=200.00, max=240.00, avg=220.00

--- Scenario 2 Results ---
Sample ID: sales_stable
Model: sfm-moe-v1
Timestamps: ['2023-01-06', '2023-01-07', '2023-01-08']
Values: [102.0, 101.0, 103.0]
Forecast stats: min=101.00, max=103.00, avg=102.00

--- Scenario 3 Results ---
Sample ID: sales_declining
Model: sfm-moe-v1
Timestamps: ['2023-01-06', '2023-01-07', '2023-01-08']
Values: [150.0, 140.0, 130.0]
Forecast stats: min=130.00, max=150.00, avg=140.00
```

## Configuration

### Base URL
All examples are configured to use `http://localhost:8014` as the base URL. To use a different endpoint, modify the `base_url` parameter in the `SynthefyAPIClient` constructor:

```python
client = SynthefyAPIClient(
    api_key=api_key,
    base_url="https://your-server.com"  # Change this
)
```

### Model
The examples use the `sfm-moe-v1` model. You can change this by modifying the `model` parameter in the `ForecastV2Request`:

```python
request = ForecastV2Request(samples=samples, model="your-model-name")
```

## Error Handling

All examples include comprehensive error handling for common issues:

- **BadRequestError (400, 422)**: Invalid request data
- **AuthenticationError (401)**: Invalid API key
- **RateLimitError (429)**: Rate limit exceeded
- **APITimeoutError**: Request timeout
- **APIConnectionError**: Network/connection issues
- **InternalServerError (5xx)**: Server errors

## Troubleshooting

### Common Issues

1. **"SYNTHEFY_API_KEY environment variable not set"**
   - Make sure you've set the environment variable: `export SYNTHEFY_API_KEY='your_key'`

2. **Connection Error**
   - Ensure the server is running on `http://localhost:8014`
   - Check your network connection

3. **Authentication Error**
   - Verify your API key is correct
   - Check that the API key has the necessary permissions

4. **Bad Request Error**
   - Check the request format matches the expected schema
   - Ensure all required fields are provided
   - Verify data types are correct (timestamps as strings, values as numbers)

### Debug Mode

To see more detailed error information, you can modify the examples to print the full response:

```python
except BadRequestError as e:
    print(f"❌ Bad Request Error: {e}")
    print(f"Status Code: {e.status_code}")
    print(f"Request ID: {e.request_id}")
    print(f"Error Code: {e.error_code}")
    print(f"Response Body: {e.response_body}")
```

## API Reference

For more detailed information about the Synthefy client, see:
- [Synthefy PyPI Package](https://pypi.org/project/synthefy/)
- [API Documentation](https://docs.synthefy.com)

## Support

For questions or issues:
- Email: contact@synthefy.com
- Check the error messages and troubleshooting section above
